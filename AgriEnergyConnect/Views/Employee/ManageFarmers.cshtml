@model AgriEnergyConnect.Models.Tables.Farmer[]?

@{
    ViewData["Title"] = "ManageFarmers";
}

@section Styles {

    <style type="text/css">
    
        #background {
            background-image: url('../images/wheat-farm.png');
            background-size: 100%;
        }

        .content {
            color: white;
        }
    
    </style>

}

@section Scripts {

    <script type="text/javascript">
    
        // Occurs when the user clicks the 'Add Farmer' button.
        function AddFarmer()
        {
            document.getElementById("add-farmer").hidden = false;
            document.getElementById("remove-farmer").hidden = true;
            document.getElementById("update-farmer").hidden = true;
        }

        // Occurs when the user clicks the 'Remove Farmer' button.
        function RemoveFarmer()
        {
            document.getElementById("add-farmer").hidden = true;
            document.getElementById("remove-farmer").hidden = false;
            document.getElementById("update-farmer").hidden = true;
        }

        // Occurs when the user clicks the 'Update Farmer' button.
        function UpdateFarmer()
        {
            document.getElementById("add-farmer").hidden = true;
            document.getElementById("remove-farmer").hidden = true;
            document.getElementById("update-farmer").hidden = false;
        }

        // Occurs when the user clicks the 'Submit' button.
        function SubmitFarmerReg() { 

            // Get the field data.
            let firstName = document.getElementById("txtFirstName").value;
            let lastName = document.getElementById("txtLastName").value;
            let emailAddress = document.getElementById("txtEmailAddress").value;
            let cellphoneNumber = document.getElementById("txtCellphoneNumber").value;
            let gender = document.getElementById("rbMale").checked ? "M" : "F";
            let userName = document.getElementById("txtUserName").value;
            let password = document.getElementById("txtPassword").value;
            let confirmPassword = document.getElementById("txtConfirmPassword").value;

            // Perform a validation check.
            let validation = firstName.length > 0 &&
                lastName.length > 0 &&
                emailAddress.length > 0 &&
                cellphoneNumber.length > 0 &&
                userName.length > 0 &&
                IsStrongPassword(password) &&
                password == confirmPassword;

            // Check if the validation succeeded.
            if(validation)
            {
                // Create a new object.
                let regInfo = new Object();
                regInfo.FirstName = firstName;
                regInfo.LastName = lastName;
                regInfo.EmailAddress = emailAddress;
                regInfo.CellphoneNumber = cellphoneNumber;
                regInfo.Gender = gender;
                regInfo.UserName = userName;
                regInfo.Password = password;
                regInfo.ConfirmPassword = confirmPassword;

                // Perform a POST operation.
                POST("/Employee/ManageFarmers", JSON.stringify(regInfo), [["ActionName", "AddFarmer"]], function (status) {

                    // Check if the status is OK.
                    if(status == 1)
                    {
                        document.location.reload();
                    }

                });
            }
        }
        
        // Occurs when the user clicks the 'Cancel' button.
        function CancelFarmerReg() {
            document.getElementById("add-farmer").hidden = true;
        }

        // Occurs when the user selected the radio button 'Male'.
        function rbMale_onclick()
        {
            document.getElementById("rbMale").checked = true;
            document.getElementById("rbFemale").checked = false;
        }

        // Occurs when the user selected the radio button 'Female'.
        function rbFemale_onclick() {
            document.getElementById("rbMale").checked = false;
            document.getElementById("rbFemale").checked = true;
        }

        // Occurs when the user is requesting a farmer to be removed from the database.
        function RequestFarmerRemoval() { 
            let farmerId = document.getElementById("farmerID").value;

            if(farmerId.length > 0)
            {
                // Perform a POST operation.
                POST("/Employee/ManageFarmers", farmerId, [["ActionName", "RemoveFarmer"]], function (status) {

                    // Check if the status is OK.
                    if(status == 1)
                    {
                        document.location.reload();
                    }
                });
            }
        }

        // Occurs when the user is cancelling the request for a farmer to be removed.
        function CancelFarmerRemoval() { 
            document.getElementById("remove-farmer").hidden = true;
        }

        // Occurs when the user selected the radio button 'Male'.
        function rbMale2_onclick() { 
            document.getElementById("rbMale2").checked = true;
            document.getElementById("rbFemale2").checked = false;
        }

        // Occurs when the user selected the radio button 'Female'.
        function rbFemale2_onclick() {
            document.getElementById("rbMale2").checked = false;
            document.getElementById("rbFemale2").checked = true;
        }

        // Occurs when the user clicked the button 'Update'.
        function UpdateFarmerInfo() { 
            // Get the field data.
            let farmerID = parseInt(document.getElementById("farmerID2").value, 10);
            let firstName = document.getElementById("txtFirstName2").value;
            let lastName = document.getElementById("txtLastName2").value;
            let emailAddress = document.getElementById("txtEmailAddress2").value;
            let cellphoneNumber = document.getElementById("txtCellphoneNumber2").value;
            let gender = document.getElementById("rbMale2").checked ? "M" : "F";
            let userName = document.getElementById("txtUserName2").value;
            
            // Perform a validation check.
            let validation = firstName.length > 0 &&
                             lastName.length > 0 &&
                             emailAddress.length > 0 &&
                             cellphoneNumber.length > 0 &&
                             userName.length > 0;

            // Check if the validation succeeded.
            if(validation)
            {
                // Create a new object.
                let userProfile = new Object();
                userProfile.UserID = farmerID;
                userProfile.FirstName = firstName;
                userProfile.LastName = lastName;
                userProfile.EmailAddress = emailAddress;
                userProfile.CellphoneNumber = cellphoneNumber;
                userProfile.Gender = gender;
                userProfile.UserName = userName;

                // Perform a POST operation.
                POST("/Employee/ManageFarmers", JSON.stringify(userProfile), [["ActionName", "UpdateFarmer"]], function (status) {

                    // Check if the status is OK.
                    if(status == 1)
                    {
                        document.location.reload();
                    }

                });
            }
        }

    </script>

}

<div style="margin-top: 16px;">
    <div class="content">
        <h1 style="background-color: black; width: fit-content">Manage Farmers</h1>

        <div style="width: 100%; background-color: white; border-radius: 8px; padding: 16px">

            <button class="btn-class btn-small" onclick="AddFarmer()">Add Farmer</button>
            <button class="btn-class btn-small" onclick="RemoveFarmer()">Remove Farmer</button>
            <button class="btn-class btn-small" onclick="UpdateFarmer()">Update Farmer</button>

            <hr style="color: #333333; height: 3px" />

            <div id="add-farmer" hidden>
                
                <div style="width: fit-content; color: black">
                    <table style="width: 100%">

                        <tr>
                            <th>First Name:</th>
                            <td><input id="txtFirstName" type="text" value="" /></td>
                        </tr>
                        <tr>
                            <th>Last Name:</th>
                            <td><input id="txtLastName" type="text" value="" /></td>
                        </tr>
                        <tr>
                            <th>Email Address:</th>
                            <td><input id="txtEmailAddress" type="email" value="" /></td>
                        </tr>
                        <tr>
                            <th>Cellphone Number:</th>
                            <td><input id="txtCellphoneNumber" type="text" value="" /></td>
                        </tr>
                        <tr>
                            <th>Gender:</th>
                            <td><input id="rbMale" type="radio" onclick="rbMale_onclick()" /> Male <input id="rbFemale" type="radio" onclick="rbFemale_onclick()" /> Female</td>
                        </tr>
                        <tr>
                            <th>UserName:</th>
                            <td><input id="txtUserName" type="text" value="" /></td>
                        </tr>
                        <tr>
                            <th>Password:</th>
                            <td><input id="txtPassword" type="password" value="" /></td>
                        </tr>
                        <tr>
                            <th>Re-enter Password:</th>
                            <td><input id="txtConfirmPassword" type="password" value="" /></td>
                        </tr>
                    </table>
                    <div align="right" style="width: 410px">
                        <button onclick="SubmitFarmerReg()">Submit</button>
                        <button onclick="CancelFarmerReg()">Cancel</button>
                    </div>

                    <hr style="color: #333333; height: 3px" />
                </div>
            </div>

            <div id="remove-farmer" hidden>

               <div style="width: fit-content; color: black">
                   Please enter a farmer ID to continue.<br />
                   <b>Farmer ID: </b>

                    <select id="farmerID">
                        
                        <!-- Iterate through the collection -->
                        @foreach (var farmer in this.Model)
                        {
                            <option>@farmer.FarmerID</option>
                        }

                    </select>

                   <br />
                   <div align="right">
                       <button onclick="RequestFarmerRemoval()">Remove</button>
                       <button onclick="CancelFarmerRemoval()">Cancel</button>
                   </div>

                    <hr style="color: #333333; height: 3px" />
               </div>

            </div>

            <div id="update-farmer" hidden>

                <div style="width: fit-content; color: black">
                    
                    <table style="width: 100%">

                        <tr>
                            <th>Farmer ID</th>
                            <td>
                                <select id="farmerID2">

                                    <!-- Iterate through the collection -->
                                    @foreach(var farmer in this.Model)
                                    {
                                        <option>@farmer.FarmerID</option>
                                    }

                                </select>
                            </td>
                        </tr>
                        <tr>
                            <th>First Name:</th>
                            <td><input id="txtFirstName2" type="text" value="" /></td>
                        </tr>
                        <tr>
                            <th>Last Name:</th>
                            <td><input id="txtLastName2" type="text" value="" /></td>
                        </tr>
                        <tr>
                            <th>Email Address:</th>
                            <td><input id="txtEmailAddress2" type="text" value="" /></td>
                        </tr>
                        <tr>
                            <th>Cellphone Number:</th>
                            <td><input id="txtCellphoneNumber2" type="text" value="" /></td>
                        </tr>
                        <tr>
                            <th>Gender:</th>
                            <td><input id="rbMale2"" type="radio" onclick="rbMale2_onclick()" /> Male <input id="rbFemale2" type="radio" onclick="rbFemale2_onclick()" /> Female</td>
                        </tr>
                        <tr>
                            <th>UserName:</th>
                            <td><input id="txtUserName2" type="text" value="" /></td>
                        </tr>
                    </table>
                    <div align="right">
                        <button onclick="UpdateFarmerInfo()">Submit</button>
                        <button onclick="CancelUpdate()">Cancel</button>
                    </div>

                    <hr style="color: #333333; height: 3px" />

                </div>

            </div>


            <table style="width: 100%; color: black" cellpadding="4">

                <tr>
                    <th>Farmer ID:</th>
                    <th>First Name:</th>
                    <th>Last Name:</th>
                    <th>Email Address:</th>
                    <th>Cellphone Number:</th>
                    <th>Gender:</th>
                    <th>UserName:</th>
                </tr>

                @if(this.Model != null)
                {
                    <!-- Iterate through the collection. -->
                    @foreach(var farmer in this.Model)
                    {
                        <tr>
                            <td>@farmer.FarmerID</td>
                            <td>@farmer.FirstName</td>
                            <td>@farmer.LastName</td>
                            <td>@farmer.EmailAddress</td>
                            <td>@farmer.CellphoneNumber</td>
                            <td>@farmer.Gender</td>
                            <td>@farmer.UserName</td>
                        </tr>
                    }
                }
            </table>
        </div>

    </div>
</div>
